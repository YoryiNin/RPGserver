# Usar una imagen base de Ubuntu para el contenedor
FROM ubuntu:20.04

# Instalar dependencias necesarias para Unity headless
RUN apt-get update && apt-get install -y \
    libglib2.0-0 \
    libsm6 \
    libxext6 \
    libxrandr2 \
    libxi6 \
    libxcursor1 \
    libxinerama1 \
    ca-certificates \
    && rm -rf /var/lib/apt/lists/*

# Establecer el directorio de trabajo dentro del contenedor
WORKDIR /app

# Copiar los archivos generados en el build de Unity al contenedor
COPY . /app

# Dar permisos de ejecución al ejecutable de Unity
RUN chmod +x juego.x86_64

# Exponer el puerto que usará el juego para la conexión (usualmente 7777)
EXPOSE 7777

# Iniciar el servidor headless con Unity
CMD ["./juego.x86_64", "-batchmode", "-nographics", "-logfile", "/dev/stdout"]

